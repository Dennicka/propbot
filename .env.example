# --- Runtime profile & safety guards ---
# WARNING: PROFILE=live together with SAFE_MODE=false and DRY_RUN_ONLY=false sends
# real orders to the connected exchange. Always launch in HOLD/SAFE_MODE=true,
# validate limits and balances, then resume trading deliberately.
PROFILE=paper                     # Broker profile: paper | testnet | live
MODE=paper                        # Deployment label shown in System Status
SAFE_MODE=true                    # Blocks live order placement when true
DRY_RUN_ONLY=false                # Force internal simulator regardless of PROFILE
DRY_RUN_MODE=false                # Simulate hedge execution without sending real exchange orders
TWO_MAN_RULE=true                 # Require manual approvals before resuming RUN
AUTOPILOT_ENABLE=false            # Allow autonomous resume from HOLD only when explicitly enabled
POST_ONLY=true                    # Submit post-only orders where supported
REDUCE_ONLY=false                 # Restrict orders to position-reducing actions
ENABLE_PLACE_TEST_ORDERS=false    # Allow Binance testnet order placement when SAFE_MODE=false
ORDER_NOTIONAL_USDT=50            # Default loop order size in USDT
MAX_SLIPPAGE_BPS=2                # Maximum allowed execution slippage (basis points)
MIN_SPREAD_BPS=0.0                # Minimum spread required to trade (basis points)
TAKER_FEE_BPS_BINANCE=2           # Expected taker fee for Binance (bps)
TAKER_FEE_BPS_OKX=2               # Expected taker fee for OKX (bps)
POLL_INTERVAL_SEC=5               # Loop sleep interval between cycles (seconds)
LOOP_PAIR=                        # Optional fixed trading pair (e.g. BTCUSDT)
LOOP_VENUES=                      # Optional comma-separated venue list (e.g. binance-um,okx-perp)
MAX_ORDERS_PER_MIN=300            # Runaway breaker: maximum orders submitted per rolling minute
MAX_CANCELS_PER_MIN=600           # Runaway breaker: maximum cancels issued per rolling minute

# --- Risk limits ---
MAX_POSITION_USDT=25000           # Default per-symbol notional cap (USDT)
MAX_POSITION_USDT__BTCUSDT=50000  # Example override for BTCUSDT
MAX_OPEN_ORDERS=5                 # Default maximum outstanding orders across venues
MAX_OPEN_ORDERS__binance-um=10    # Example venue-specific override
MAX_DAILY_LOSS_USDT=2500          # Absolute drawdown stop before auto-HOLD (USDT)
MAX_TOTAL_NOTIONAL_USD=0          # Aggregate exposure cap before auto-HOLD (USD, 0 disables)
MAX_UNREALIZED_LOSS_USD=0         # Unrealized loss cap before auto-HOLD (USD, 0 disables)
CLOCK_SKEW_HOLD_THRESHOLD_MS=200  # Auto-HOLD if |clock skew| exceeds this threshold (ms)

# --- Risk core scaffold ---
MAX_OPEN_POSITIONS=3              # Risk core: maximum simultaneous positions allowed
MAX_TOTAL_NOTIONAL_USDT=75000     # Risk core: aggregate open notional cap across venues (USDT)
MAX_NOTIONAL_PER_EXCHANGE=        # Risk core: comma-separated mapping, e.g. binance-um:50000; blank disables
RISK_CHECKS_ENABLED=false         # Risk core: master feature flag for governor/accounting enforcement
RISK_ENFORCE_CAPS=false           # Risk core: enforce MAX_TOTAL_NOTIONAL/MAX_OPEN_POSITIONS when true
RISK_ENFORCE_BUDGETS=false        # Risk core: enforce per-strategy budget drawdown caps when true

# --- Cross-exchange hedging ---
MAX_NOTIONAL_PER_POSITION_USDT=25000  # Per-position notional cap for hedges (USDT)
MAX_LEVERAGE=5                    # Maximum leverage allowed for hedges
SCAN_INTERVAL_SEC=5               # Opportunity scanner interval (seconds)
SCAN_LEVERAGE_SUGGESTION=1.0      # Default leverage suggestion for scanned opportunities
AUTO_HEDGE_ENABLED=false          # Enable automatic hedge execution daemon
AUTO_HEDGE_SCAN_SECS=2            # Auto hedge scan interval (seconds)
MAX_AUTO_FAILS_PER_MIN=3          # Failure threshold per minute before auto-HOLD

# --- Authentication & rate limits ---
AUTH_ENABLED=true                 # Require API_TOKEN for mutating routes when true
API_TOKEN=change-me               # Bearer token for CLI / API clients
IDEM_TTL_SEC=600                  # Idempotency cache TTL in seconds
API_RATE_PER_MIN=30               # Rate limit refill tokens per minute
API_BURST=10                      # Maximum burst tokens for rate limiting
APPROVE_TOKEN=                    # Two-man resume approval token (required for /resume-confirm)
SECRETS_STORE_PATH=./data/secrets_store.json  # Path to JSON secrets store consumed by SecretsStore (see README for schema; never commit this)
SECRETS_ENC_KEY="change-me"       # Optional XOR/base64 placeholder key for encrypting secrets at rest

# --- Telegram control bot ---
TELEGRAM_ENABLE=false             # Enable Telegram control/ops alerts bot
TELEGRAM_BOT_TOKEN=               # Bot token issued by @BotFather
TELEGRAM_CHAT_ID=                 # Authorised chat/user ID for commands & alerts
TELEGRAM_PUSH_MINUTES=5           # Interval between automatic status messages

# --- Runtime persistence ---
RUNTIME_STATE_PATH=./data/runtime_state.json  # File storing last applied control snapshot
POSITIONS_STORE_PATH=data/hedge_positions.json  # Persistent cross-exchange hedge positions ledger
PNL_HISTORY_PATH=data/pnl_history.json  # Rolling exposure / PnL history snapshots for the operator dashboard

# --- Binance UM testnet credentials ---
BINANCE_UM_API_KEY_TESTNET=       # Binance UM testnet API key
BINANCE_UM_API_SECRET_TESTNET=    # Binance UM testnet API secret
BINANCE_UM_BASE_TESTNET=https://testnet.binancefuture.com  # Optional custom testnet base URL

# --- Binance Futures live credentials (REAL FUNDS) ---
BINANCE_LV_API_KEY=               # Binance Futures live API key (protect carefully)
BINANCE_LV_API_SECRET=            # Binance Futures live API secret
BINANCE_LV_BASE_URL=https://fapi.binance.com  # Optional custom live base URL
BINANCE_LV_API_KEY_TESTNET=       # Optional placeholder for segregated live/test configs
BINANCE_LV_API_SECRET_TESTNET=

# --- Binance hedge executor credentials (used for cross-exchange futures) ---
BINANCE_API_KEY=                  # Optional fallback Binance API key for local dev (SecretsStore preferred)
BINANCE_API_SECRET=               # Optional fallback Binance API secret for local dev (SecretsStore preferred)
BINANCE_FUTURES_API_URL=https://fapi.binance.com  # Optional override of the Binance futures REST base URL

# --- OKX testnet credentials (optional) ---
OKX_API_KEY_TESTNET=
OKX_API_SECRET_TESTNET=
OKX_API_PASSPHRASE_TESTNET=

# --- OKX hedge executor credentials ---
OKX_API_KEY=                      # Optional fallback OKX API key for local dev (SecretsStore preferred)
OKX_API_SECRET=                   # Optional fallback OKX API secret for local dev (SecretsStore preferred)
OKX_API_PASSPHRASE=               # Optional fallback OKX API passphrase for local dev (SecretsStore preferred)
OKX_FUTURES_API_URL=https://www.okx.com  # Optional override of the OKX REST base URL

