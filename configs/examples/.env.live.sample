# -----------------------------------------------------------------------------
# PropBot live deployment environment sample
# -----------------------------------------------------------------------------
# Copy this file to `.env` on the live host and replace placeholders with
# production credentials. Secrets must never be committed to Git.
# -----------------------------------------------------------------------------

# --- PropBot runtime profile & service host ---
APP_ENV=production                # Environment label for logs/systemd units
DEFAULT_PROFILE=live              # Fallback config bundle (paper|testnet|live)
API_HOST=0.0.0.0                  # Bind address for FastAPI
API_PORT=8000                     # HTTP port for FastAPI
PROFILE=live                      # Exchange profile used to load configs
MODE=live                         # Deployment label shown in status/ops report
SAFE_MODE=true                    # Blocks live order placement until resume
DRY_RUN_ONLY=false                # Force in-memory simulator regardless of profile
DRY_RUN_MODE=false                # Simulate hedge execution without touching exchanges
TWO_MAN_RULE=true                 # Require two operator approvals before RUN
AUTOPILOT_ENABLE=false            # Allow autonomous resume after restart when true
POST_ONLY=true                    # Submit post-only orders where supported
REDUCE_ONLY=false                 # Restrict orders to position-reducing actions
ENABLE_PLACE_TEST_ORDERS=false    # Allow Binance testnet orders when SAFE_MODE=false
ORDER_NOTIONAL_USDT=50            # Default loop order size in USDT
MAX_SLIPPAGE_BPS=2                # Maximum allowed execution slippage (basis points)
MIN_SPREAD_BPS=0.0                # Minimum spread required to trade (basis points)
TAKER_FEE_BPS_BINANCE=2           # Expected taker fee for Binance (bps)
TAKER_FEE_BPS_OKX=2               # Expected taker fee for OKX (bps)
POLL_INTERVAL_SEC=5               # Loop sleep interval between cycles (seconds)
LOOP_PAIR=                        # Optional fixed trading pair (e.g. BTCUSDT)
LOOP_VENUES=                      # Optional comma-separated venues (e.g. binance-um,okx-perp)
MAX_ORDERS_PER_MIN=120            # Runaway breaker: max orders submitted per rolling minute
MAX_CANCELS_PER_MIN=240           # Runaway breaker: max cancels issued per rolling minute

# --- Risk flags & caps ---
RISK_CHECKS_ENABLED=true          # Master switch for risk governor/accounting
RISK_ENFORCE_CAPS=true            # Enforce open-trade & notional caps
ENFORCE_MAX_OPEN_TRADES=true      # Alias for RISK_ENFORCE_CAPS
MAX_OPEN_POSITIONS=5              # Maximum simultaneous trades (UI: max_open_trades_limit)
MAX_OPEN_TRADES=5                 # Alias for MAX_OPEN_POSITIONS
MAX_TOTAL_NOTIONAL_USDT=75000     # Aggregate open notional cap across venues (USDT)
MAX_TOTAL_NOTIONAL_USD=0          # Optional legacy alias for total notional cap (USD)
ENFORCE_MAX_NOTIONAL_USDT=true    # Alias for RISK_ENFORCE_CAPS
ENFORCE_DAILY_LOSS_CAP=true       # Enables runtime enforcement of the daily loss cap
DAILY_LOSS_CAP_ENABLED=true       # Alias for ENFORCE_DAILY_LOSS_CAP
DAILY_LOSS_CAP_USDT=2500          # Global realized PnL cap in USDT (0 disables)
DAILY_LOSS_USDT=2500              # Alias for DAILY_LOSS_CAP_USDT
DAILY_LOSS_CAP_AUTO_HOLD=true     # Automatically engage HOLD when the cap is breached
MAX_POSITION_USDT=25000           # Default per-symbol notional cap (USDT)
MAX_POSITION_USDT__BTCUSDT=50000  # Example override for BTCUSDT
MAX_OPEN_ORDERS=5                 # Default maximum outstanding orders across venues
MAX_OPEN_ORDERS__binance-um=10    # Example venue-specific override
MAX_DAILY_LOSS_USDT=2500          # Legacy drawdown stop before auto-HOLD
MAX_UNREALIZED_LOSS_USD=0         # Unrealized loss cap before auto-HOLD (USD, 0 disables)
CLOCK_SKEW_HOLD_THRESHOLD_MS=150  # Auto-HOLD if |clock skew| exceeds this threshold (ms)

# --- Daily PnL & reporting ---
EXCLUDE_DRY_RUN_FROM_PNL=true     # Drop simulated fills from strategy PnL aggregates
STRATEGY_BUDGET_FILE=             # Optional override for StrategyBudgetManager JSON

# --- Autopilot guard & watchdog ---
AUTOPILOT_GUARD_INTERVAL_SEC=5    # Evaluation interval for the autopilot guard (seconds)
AUTOPILOT_GUARD_ENABLED=true      # Guard loads on startup; remove hook to disable
WATCHDOG_ENABLED=true             # Enable exchange watchdog heartbeat daemon
WATCHDOG_INTERVAL_SEC=7           # Seconds between watchdog checks
WATCHDOG_AUTO_HOLD=true           # Engage HOLD automatically when watchdog degrades
NOTIFY_WATCHDOG=true              # Emit ops alerts for watchdog transitions
WATCHDOG_BASE_URL=                # Optional override for watchdog webhook callbacks

# --- Observability ---
PROMETHEUS_ENABLED=true           # Prometheus endpoint is exposed by default
SLO_EXPORT_ENABLED=true           # Export SLO metrics to `/metrics`
FEATURE_SLO=1                     # Enable SLO monitoring loop
SLO_LATENCY_P95_TARGET_MS=250     # Target p95 latency (ms) for UI/core
SLO_ERROR_RATE_TARGET=0.02        # Allowed error ratio (0..1)
SLO_EVALUATION_INTERVAL_SEC=60    # Interval between SLO checks (seconds)
SMOKE_HOST=https://propbot.example.com  # Base URL for scripts/smoke.sh
SMOKE_TIMEOUT=5                   # Curl timeout for smoke checks (seconds)

# --- Reconciliation ---
RECON_ENABLED=true                # Enable reconciliation runner
RECON_AUTO_HOLD=true              # Engage HOLD automatically on severe mismatches
SHOW_RECON_STATUS=true            # Render reconciliation widget/status in the operator dashboard

# --- Chaos testing ---
FEATURE_CHAOS=0                   # Disable chaos injection on live
CHAOS_PROFILE=                    # Name of chaos profile from configs/fault_profiles.yaml
CHAOS_WS_DROP_P=0.0               # Probability of dropping websocket updates (0..1)
CHAOS_REST_TIMEOUT_P=0.0          # Probability of simulating REST timeout (0..1)
CHAOS_ORDER_DELAY_MS=0            # Artificial delay (ms) before order/cancel operations

# --- Cross-exchange hedging ---
MAX_NOTIONAL_PER_POSITION_USDT=25000  # Per-position notional cap for hedges (USDT)
MAX_LEVERAGE=5                    # Maximum leverage allowed for hedges
SCAN_INTERVAL_SEC=5               # Opportunity scanner interval (seconds)
SCAN_LEVERAGE_SUGGESTION=1.0      # Default leverage suggestion for scanned opportunities
AUTO_HEDGE_ENABLED=false          # Enable automatic hedge execution daemon
AUTO_HEDGE_SCAN_SECS=2            # Auto hedge scan interval (seconds)
MAX_AUTO_FAILS_PER_MIN=3          # Failure threshold per minute before auto-HOLD

# --- Authentication & rate limits ---
AUTH_ENABLED=true                 # Require API_TOKEN for mutating routes
API_TOKEN=change-me               # Bearer token for CLI / API clients (replace!)
IDEM_TTL_SEC=600                  # Idempotency cache TTL in seconds
API_RATE_PER_MIN=60               # Rate limit refill tokens per minute
API_BURST=20                      # Maximum burst tokens for rate limiting
APPROVE_TOKEN=                    # Two-man resume approval token (set for live)
SECRETS_STORE_PATH=./data/secrets_store.json  # Path to JSON secrets store (never commit real data)
SECRETS_ENC_KEY="change-me"       # Placeholder key for encrypting secrets at rest

# --- Telegram control bot ---
TELEGRAM_ENABLE=true              # Enable Telegram control/ops alerts bot
TELEGRAM_BOT_TOKEN=               # Bot token issued by @BotFather (set securely)
TELEGRAM_CHAT_ID=                 # Authorised chat/user ID for commands & alerts
TELEGRAM_PUSH_MINUTES=5           # Interval between automatic status messages

# --- Runtime persistence ---
RUNTIME_STATE_PATH=./data/runtime_state.json  # Control snapshot storage
POSITIONS_STORE_PATH=data/hedge_positions.json  # Persistent cross-exchange hedge positions ledger
PNL_HISTORY_PATH=data/pnl_history.json  # Rolling exposure / PnL history snapshots
STRATEGY_PNL_STATE_PATH=data/strategy_pnl.json  # Persistent strategy PnL tracker store
HEDGE_LOG_PATH=data/hedge_log.json     # Optional hedge execution audit log
OPS_ALERTS_FILE=data/ops_alerts.json   # Optional ops alerts export

# --- Binance UM testnet credentials (kept for paper/testnet switching) ---
BINANCE_UM_API_KEY_TESTNET=       # Binance UM testnet API key
BINANCE_UM_API_SECRET_TESTNET=    # Binance UM testnet API secret
BINANCE_UM_BASE_TESTNET=https://testnet.binancefuture.com  # Optional custom testnet base URL

# --- Binance Futures live credentials (REAL FUNDS) ---
BINANCE_LV_API_KEY=               # Binance Futures live API key (secure storage only)
BINANCE_LV_API_SECRET=            # Binance Futures live API secret
BINANCE_LV_BASE_URL=https://fapi.binance.com  # Optional custom live base URL
BINANCE_LV_API_KEY_TESTNET=       # Optional placeholder for segregated configs
BINANCE_LV_API_SECRET_TESTNET=

# --- Binance hedge executor credentials ---
BINANCE_API_KEY=                  # Optional fallback Binance API key (use secrets store)
BINANCE_API_SECRET=               # Optional fallback Binance API secret (use secrets store)
BINANCE_FUTURES_API_URL=https://fapi.binance.com  # Optional override of the Binance futures REST base URL

# --- OKX testnet credentials (optional) ---
OKX_API_KEY_TESTNET=
OKX_API_SECRET_TESTNET=
OKX_API_PASSPHRASE_TESTNET=

# --- OKX hedge executor credentials ---
OKX_API_KEY=                      # Optional fallback OKX API key (use secrets store)
OKX_API_SECRET=                   # Optional fallback OKX API secret (use secrets store)
OKX_API_PASSPHRASE=               # Optional fallback OKX API passphrase (use secrets store)
OKX_FUTURES_API_URL=https://www.okx.com  # Optional override of the OKX REST base URL
