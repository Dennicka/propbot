profile: testnet.bybit
control:
  safe_mode: true
  dry_run: true
  two_man_rule: true
  post_only: true
  reduce_only: false
health:
  guard_enabled: true
  margin_ratio_warn: 0.75
  margin_ratio_critical: 0.85
  free_collateral_warn_usd: 100.0
  free_collateral_critical_usd: 10.0
  hysteresis_ok_windows: 2
api:
  base_url: http://127.0.0.1:8000
guards:
  cancel_on_disconnect: true
  rate_limit:
    place_per_min: 300
    cancel_per_min: 600
  clock_skew_guard_ms: 150
  snapshot_diff_check: true
  kill_caps:
    enabled: true
    flatten_on_breach: true
  runaway_breaker:
    place_per_min: 300
    cancel_per_min: 600
  maintenance_calendar: []
pretrade:
  allow_autofix: true
  default_tz: "UTC"
exposure_caps:
  default:
    max_abs_usdt: 2000
    per_side_max_abs_usdt:
      LONG: 1500
      SHORT: 1500
  per_symbol: {}
  per_venue: {}
maintenance:
  windows:
    - from: "02:00"
      to: "02:15"
      tz: "Europe/Stockholm"
      reason: "Daily ops"
guardrails:
  testnet_block_highrisk: true
  blocklist:
    - "BTCUSDT"
    - "ETHUSDT"
market:
  ws:
    hb_timeout_s: 3.0
    backoff_base_s: 0.25
    backoff_max_s: 30.0
    stable_window_s: 60.0
  resync:
    max_snapshot_depth: 1000
    retry_policy:
      max_attempts: 3
      backoff_s: 1.0
  auto_hold_on_down: true
  block_on_down: true
  error_budget_window_s: 600
  thresholds:
    ws_lag_ms_p95:
      degraded: 400
      down: 1200
    ws_disconnects_per_min:
      degraded: 2
      down: 6
    rest_5xx_rate:
      degraded: 0.02
      down: 0.10
    rest_timeouts_rate:
      degraded: 0.02
      down: 0.10
    order_reject_rate:
      degraded: 0.01
      down: 0.05
risk:
  max_day_drawdown_bps: 300
  notional_caps:
    per_symbol_usd: 1200
    per_venue_usd: 3200
    total_usd: 5000
  cross_venue_delta_abs_max_usd: 200
  runaway:
    max_cancels_per_min: 600
    cooldown_sec: 60
  governor:
    window_sec: 3600
    min_success_rate: 0.985
    max_order_error_rate: 0.01
    min_broker_state: UP
    hold_after_windows: 2
execution:
  stuck_resolver:
    enabled: false
    pending_timeout_sec: 8
    cancel_grace_sec: 3
    max_retries: 3
    backoff_sec: [1, 2, 5]
obs:
  metrics_interval_sec: 5
recon:
  enabled: true
  interval_s: 20
  epsilon_position: 0.0001
  epsilon_balance: 0.5
  epsilon_notional: 5.0
  auto_hold_on_critical: true
  balance_warn_usd: 10
  balance_critical_usd: 100
  position_size_warn: 0.001
  position_size_critical: 0.01
  order_critical_missing: true
readiness:
  startup_timeout_sec: 120
status_thresholds_file: status_thresholds.yaml
derivatives:
  venues:
    - id: bybit_perp
      testnet: true
      api_key_env: "BYBIT_TESTNET_API_KEY"
      api_secret_env: "BYBIT_TESTNET_API_SECRET"
      symbols: ["BTCUSDT", "ETHUSDT"]
      leverage: 10
      margin_type: isolated
      position_mode: hedge
      routing:
        rest: "https://api-testnet.bybit.com"
        ws: "wss://stream-testnet.bybit.com/v5/public/linear"
  arbitrage:
    pairs: []
    min_edge_bps: 6
    max_latency_ms: 250
    max_leg_slippage_bps: 3
    prefer_maker: false
    post_only_maker: true
    partial_fill_policy: reject_if_unhedged
  fees:
    source: "manual"
    manual:
      bybit_perp:
        maker_bps: 2.5
        taker_bps: 5.0
        vip_rebate_bps: 0.0
  funding:
    include_next_window: true
    avoid_window_minutes: 5
tca:
  horizon_min: 60
  impact:
    k: 25.0
  tiers:
    bybit_perp:
      - tier: VIP0
        maker_bps: 2.5
        taker_bps: 5.0
        rebate_bps: 0.0
        notional_from: 0
      - tier: VIP5
        maker_bps: 1.5
        taker_bps: 4.0
        rebate_bps: 0.1
        notional_from: 1000000
